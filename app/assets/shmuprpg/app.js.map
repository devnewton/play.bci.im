{"version":3,"sources":["app/ShmuprpgApp.ts","app/ShmuprpgGame.ts","app/entities/Bird.ts","app/entities/BirdFlock.ts","app/entities/Bullet.ts","app/entities/Grobelin.ts","app/entities/GrobelinHorde.ts","app/entities/Hero.ts","app/entities/MachineGun.ts","app/states/AbstractState.ts","app/states/GameOver.ts","app/states/Intro.ts","app/states/Level.ts","app/states/Title.ts","app/utils/Controls.ts","app/utils/Pathfinder.ts"],"names":[],"mappings":"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","file":"public/app.js","sourcesContent":["import { ShmuprpgGame } from \"./ShmuprpgGame.ts\";\n\nnew ShmuprpgGame();","/// <reference path=\"../typings/phaser.d.ts\"/>\nimport {Intro} from \"./states/Intro.ts\";\nimport {Title} from \"./states/Title.ts\";\nimport {Level} from \"./states/Level.ts\";\nimport {GameOver} from \"./states/GameOver.ts\";\nimport {Controls} from \"./utils/Controls.ts\";\n\nexport class ShmuprpgGame extends Phaser.Game {\n\n    controls: Controls;\n\n    constructor() {\n        super(1920, 1080, Phaser.CANVAS, 'game', {\n            preload: () => this.preloadGame()\n            , create: () => this.createGame()\n        });\n        this.state.add('Intro', Intro);\n        this.state.add('Title', Title);\n        this.state.add('Level', Level);\n        this.state.add('GameOver', GameOver);\n    }\n\n    preloadGame() {\n        this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;\n        this.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;\n        this.scale.pageAlignHorizontally = true;\n        this.scale.pageAlignVertically = true;\n    }\n\n    createGame() {\n        this.controls = new Controls(this);\n        this.state.start('Level');\n    }\n\n    addSpriteAnimation(sprite: Phaser.Sprite, animationName: string, frameCount: number): Phaser.Animation {\n        return sprite.animations.add(animationName, this.genAnimArray(animationName, frameCount));\n    }\n\n    private genAnimArray(name: string, n: number) {\n        let result = new Array<string>();\n        for (let i = 0; i < n; ++i) {\n            result.push(name + i);\n        }\n        return result;\n    }\n\n}","/// <reference path=\"../../typings/phaser.d.ts\"/>\n\nexport class Bird extends Phaser.Sprite {\n\n    birdExplosion: Phaser.Sprite;\n\n    constructor(game: Phaser.Game) {\n        super(game, 0, 0, 'bird');\n        this.animations.add('fly');\n        this.game.physics.enable(this, Phaser.Physics.ARCADE);\n        this.anchor.setTo(0.5, 0.5);\n        this.checkWorldBounds = true;\n        this.outOfBoundsKill = true;\n        this.exists = false;\n        this.birdExplosion = this.game.add.sprite(this.x, this.y, 'bird-explosion');\n        this.birdExplosion.anchor.setTo(0.5, 0.5);\n        this.birdExplosion.exists = false;\n        const explodeAnimation = this.birdExplosion.animations.add('explode');\n        explodeAnimation.killOnComplete = true;\n    }\n\n    fly(fromX: number, fromY: number, angle: number) {\n        const beforeBird = this.game.add.sprite(fromX, fromY, 'before-bird');\n        beforeBird.anchor.setTo(0.5, 0.5);\n        const beforeBirdAnimation = beforeBird.animations.add('appears');\n        beforeBirdAnimation.onComplete.add(() => {\n            beforeBird.destroy();\n            this.reset(fromX, fromY);\n            this.play('fly', 8, true);\n            this.game.physics.arcade.velocityFromRotation(angle, 300, this.body.velocity);\n            this.scale.set(this.body.velocity.x < 0 ? -1 : 1, 1);\n        });\n        beforeBirdAnimation.play(4, false);\n    }\n\n    kill(): Phaser.Sprite {\n        super.kill();\n        this.birdExplosion.reset(this.x, this.y);\n        this.birdExplosion.play('explode', 8, false);\n        return this;\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport {Bird} from \"./Bird.ts\";\n\nexport class BirdFlock extends Phaser.Group {\n\n    flyRate = 1000;\n    target: Phaser.Sprite;\n    private nextFlyTime = 0;\n\n    constructor(target: Phaser.Sprite, maxBirds: number = 8) {\n        super(target.game);\n        this.target = target;\n        for (let i = 0; i < maxBirds; ++i) {\n            this.add(this.createBird());\n        }\n    }\n\n    static preload(game: Phaser.Game) {\n        game.load.spritesheet('bird', 'sprites/oga/tower-defense-prototyping-assets-4-monsters-some-tiles-a-background-image/bird.png', 48, 48, 5);\n        game.load.spritesheet('before-bird', 'sprites/oga/rpg-special-move-effects/VioletSlash.png', 64, 64, 4);\n        game.load.spritesheet('bird-explosion', 'sprites/oga/space_shooter_pack/explosion.png', 16, 16, 5);\n    }\n\n    update() {\n        super.update();\n        const x = this.game.world.randomX;\n        const y = this.game.world.randomY;\n        const angle = Phaser.Math.angleBetween(x, y, this.target.x, this.target.y);\n        this.fly(x, y, angle);\n    }\n\n    private createBird(): Bird {\n        return new Bird(this.game);\n    }\n\n    private fly(fromX: number, fromY: number, angle: number) {\n        if (this.game.time.time >= this.nextFlyTime) {\n            const bird = this.getFirstExists(false);\n            if (bird) {\n                bird.fly(fromX, fromY, angle);\n                this.nextFlyTime = this.game.time.time + this.flyRate;\n            }\n        }\n    }\n}","/// <reference path=\"../../typings/phaser.d.ts\"/>\n\nexport class Bullet extends Phaser.Sprite {\n\n    constructor(game: Phaser.Game) {\n        super(game, 0, 0, 'bullet');\n        this.game.physics.enable(this, Phaser.Physics.ARCADE);\n        this.anchor.setTo(0.5, 0.5);\n        this.checkWorldBounds = true;\n        this.outOfBoundsKill = true;\n        this.exists = false;\n    }\n    \n    fire(fromX: number, fromY: number, angle: number, speed: number, gravityX: number, gravityY: number) {\n        this.reset(fromX, fromY);\n        this.scale.set(1);\n        this.game.physics.arcade.velocityFromRotation(angle, speed, this.body.velocity);\n        this.angle = angle;\n        this.body.gravity.set(gravityX, gravityY);\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport {Level} from \"../states/Level.ts\";\nimport {Pathfinder} from \"../utils/Pathfinder.ts\";\nimport {Vulnerable} from \"./features/Vulnerable.ts\";\n\nexport class Grobelin extends Phaser.Sprite implements Vulnerable {\n\n    grobelinDeath: Phaser.Sprite;\n    enemy: Phaser.Sprite;\n    path = new Array<Phaser.Point>();\n    currentPathPointTarget: Phaser.Point;\n    thinking = false;\n    private pathfinder: Pathfinder;\n    private attackAnimation: Phaser.Animation;\n    private attackDangerousOffset: Phaser.Point;\n    private damageTween: Phaser.Tween;\n\n    constructor(game: Phaser.Game, pathfinder: Pathfinder) {\n        super(game, 0, 0, 'grobelin');\n        this.exists = false;\n        this.pathfinder = pathfinder;\n        this.game.physics.enable(this, Phaser.Physics.ARCADE);\n        this.anchor.setTo(0.5, 0.5);\n        this.checkWorldBounds = true;\n        this.outOfBoundsKill = true;\n        this.grobelinDeath = this.game.add.sprite(this.x, this.y, 'grobelin');\n        this.grobelinDeath.anchor.setTo(0.5, 0.5);\n        this.grobelinDeath.exists = false;\n    }\n\n    getVulnerableRectangles(): Array<Phaser.Rectangle> {\n        return [new Phaser.Rectangle(this.x, this.y, this.width, this.height)];\n    }\n\n    appears(fromX: number, fromY: number, target: Phaser.Sprite) {\n        const beforeGrobelin = this.game.add.sprite(fromX, fromY, 'before-bird');\n        beforeGrobelin.anchor.setTo(0.5, 0.5);\n        const beforeGrobelinAnimation = beforeGrobelin.animations.add('appears');\n        beforeGrobelinAnimation.onComplete.add(() => {\n            beforeGrobelin.destroy();\n            this.reset(fromX, fromY, 50);\n            this.body.setSize(16, 16, 24, 48);\n            this.body.collideWorldBounds = true;\n            this.path = [];\n            this.currentPathPointTarget = null;\n            this.thinking = false;\n            this.enemy = target;\n        });\n        beforeGrobelinAnimation.play(4, false);\n    }\n\n    kill(): Phaser.Sprite {\n        super.kill();\n        this.damageTween.stop(true);\n        this.tint = 0xFFFFFF;\n        this.grobelinDeath.reset(this.x, this.y);\n        this.grobelinDeath.animations.play(\"lpc.hurt\", 6, false).killOnComplete = true;\n        return this;\n    }\n\n    update() {\n        super.update();\n        if (this.exists) {\n            this.executeBehaviorTree();\n        }\n    }\n\n    damage(amount: number): Phaser.Sprite {\n        if (!this.damageTween) {\n            this.damageTween = this.game.add.tween(this).from({ tint: 0xFF0000 }).to({ tint: 0xFFFFFF }, 500, Phaser.Easing.Linear.None, true, 0, 4, false);\n            this.damageTween.onComplete.add((): void => this.damageTween = null);\n        }\n        super.damage(amount);\n        return this;\n    }\n\n    private executeBehaviorTree() {\n        this.priority_Root();\n    }\n\n    private priority_Root() {\n        this.sequence_Attack() || this.action_FollowPath() || this.action_SearchAPathToEnemy();\n    }\n\n    private sequence_Attack() {\n        return this.condition_IsNearEnemy() && this.action_AttackEnemy();\n    }\n\n    private condition_IsNearEnemy(): boolean {\n        return this.enemy && Phaser.Math.distance(this.body.center.x, this.body.center.y, this.enemy.body.center.x, this.enemy.body.center.y) < this.body.width * 2;\n    }\n\n    private action_AttackEnemy(): boolean {\n        this.body.velocity.x = 0;\n        this.body.velocity.y = 0;\n        if (!this.attackAnimation) {\n            [this.attackAnimation, this.attackDangerousOffset] = this.action_AttackEnemy_PlayAnimation();\n        } else if (this.attackAnimation.isFinished) {\n            this.attackAnimation = null;\n            const enemyRectangle = new Phaser.Rectangle(this.enemy.left, this.enemy.top, this.enemy.width, this.enemy.height);\n            if (Phaser.Rectangle.containsPoint(enemyRectangle, this.getAttackPoint())) {\n                this.enemy.damage(1);\n            }\n        }\n        return true;\n    }\n\n    getAttackPoint(): Phaser.Point {\n        if (this.attackDangerousOffset) {\n            return new Phaser.Point(this.body.center.x + this.attackDangerousOffset.x, this.body.center.y + this.attackDangerousOffset.y);\n        } else {\n            return null;\n        }\n    }\n\n    private action_AttackEnemy_PlayAnimation(): [Phaser.Animation, Phaser.Point] {\n        const dx = this.enemy.body.center.x - this.body.center.x;\n        const dy = this.enemy.body.center.y - this.body.center.y;\n        if (Math.abs(dx) > Math.abs(dy)) {\n            if (dx < 0) {\n                return [this.play(\"lpc.thrust.left\", 8, false), new Phaser.Point(-24, -16)];\n            } else if (dx > 0) {\n                return [this.play(\"lpc.thrust.right\", 8, false), new Phaser.Point(24, -16)];\n            } else if (dy < 0) {\n                return [this.play(\"lpc.thrust.back\", 8, false), new Phaser.Point(8, -48)];\n            } else if (dy > 0) {\n                return [this.play(\"lpc.thrust.front\", 8, false), new Phaser.Point(-8, 8)];\n            } else {\n                return [this.play(\"lpc.thrust.right\", 8, false), new Phaser.Point(24, -16)];\n            }\n        } else {\n            if (dy < 0) {\n                return [this.play(\"lpc.thrust.back\", 8, false), new Phaser.Point(8, -48)];\n            } else if (dy > 0) {\n                return [this.play(\"lpc.thrust.front\", 8, false), new Phaser.Point(-8, 8)];\n            } else if (dx < 0) {\n                return [this.play(\"lpc.thrust.left\", 8, false), new Phaser.Point(-24, -16)];\n            } else if (dx > 0) {\n                return [this.play(\"lpc.thrust.right\", 8, false), new Phaser.Point(24, -16)];\n            } else {\n                return [this.play(\"lpc.thrust.back\", 8, false), new Phaser.Point(8, -48)];\n            }\n        }\n    }\n\n    private action_FollowPath(): boolean {\n        if (this.currentPathPointTarget) {\n            this.action_FollowPath_MoveToXY(this.currentPathPointTarget.x, this.currentPathPointTarget.y, 300);\n            if (Phaser.Math.distance(this.body.center.x, this.body.center.y, this.currentPathPointTarget.x, this.currentPathPointTarget.y) < this.body.halfWidth) {\n                this.currentPathPointTarget = null;\n            }\n        } else {\n            this.currentPathPointTarget = this.path.shift();\n            if (this.path.length == 0) {\n                this.body.velocity.x = 0;\n                this.body.velocity.y = 0;\n                return false;\n            }\n        }\n        this.action_FollowPath_Animate();\n        return true;\n    }\n\n    private action_FollowPath_Animate() {\n        if (Math.abs(this.body.velocity.x) > Math.abs(this.body.velocity.y)) {\n            if (this.body.velocity.x < 0) {\n                this.play(\"lpc.walk.left\", 8, false);\n            } else if (this.body.velocity.x > 0) {\n                this.play(\"lpc.walk.right\", 8, false);\n            } else if (this.body.velocity.y < 0) {\n                this.play(\"lpc.walk.back\", 8, false);\n            } else if (this.body.velocity.y > 0) {\n                this.play(\"lpc.walk.front\", 8, false);\n            } else {\n                this.play(\"lpc.hurt\", 0, false);\n            }\n        } else {\n            if (this.body.velocity.y < 0) {\n                this.play(\"lpc.walk.back\", 8, false);\n            } else if (this.body.velocity.y > 0) {\n                this.play(\"lpc.walk.front\", 8, false);\n            } else if (this.body.velocity.x < 0) {\n                this.play(\"lpc.walk.left\", 8, false);\n            } else if (this.body.velocity.x > 0) {\n                this.play(\"lpc.walk.right\", 8, false);\n            } else {\n                this.play(\"lpc.hurt\", 0, false);\n            }\n        }\n    }\n\n    private action_FollowPath_MoveToXY(x: number, y: number, speed: number = 60) {\n        var angle = Math.atan2(y - this.body.center.y, x - this.body.center.x);\n        this.body.velocity.x = Math.cos(angle) * speed;\n        this.body.velocity.y = Math.sin(angle) * speed;\n    }\n\n    private action_SearchAPathToEnemy(): boolean {\n        if (!this.thinking) {\n            this.thinking = true;\n            this.pathfinder.findPath(this.body.center.x, this.body.center.y, this.enemy.body.center.x, this.enemy.body.center.y, (path: Phaser.Point[]) => {\n                this.path = path || new Array<Phaser.Point>();\n                this.thinking = false;\n            });\n        }\n        return this.path.length == 0;\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport {Grobelin} from \"./Grobelin.ts\";\nimport { ShmuprpgGame } from \"../ShmuprpgGame.ts\";\nimport { Level } from \"../states/Level.ts\";\nimport { Pathfinder } from \"../utils/Pathfinder.ts\";\n\n\nexport class GrobelinHorde extends Phaser.Group {\n\n    appearsRate = 10000;\n    target: Phaser.Sprite;\n    private nextAppearsTime = 0;\n    private pathfinder: Pathfinder;\n\n    constructor(target: Phaser.Sprite, pathFinder: Pathfinder, maxGrobelins: number = 4) {\n        super(target.game);\n        this.pathfinder = pathFinder;\n        this.target = target;\n        for (let i = 0; i < maxGrobelins; ++i) {\n            this.add(this.createGrobelin());\n        }\n    }\n\n    static preload(game: Phaser.Game) {\n        game.load.atlasXML('grobelin', 'sprites/lpc/characters/grobelin.png', 'sprites/lpc/characters/lpc.xml');\n    }\n\n    update() {\n        super.update();\n        this.appears();\n    }\n\n    private createGrobelin(): Grobelin {\n        const grobelin = new Grobelin(this.game, this.pathfinder);\n        const game = <ShmuprpgGame>this.game;\n        game.addSpriteAnimation(grobelin.grobelinDeath, 'lpc.hurt', 6);\n        game.addSpriteAnimation(grobelin, 'lpc.hurt', 6);\n        game.addSpriteAnimation(grobelin, 'lpc.walk.back', 9);\n        game.addSpriteAnimation(grobelin, 'lpc.walk.front', 9);\n        game.addSpriteAnimation(grobelin, 'lpc.walk.left', 9);\n        game.addSpriteAnimation(grobelin, 'lpc.walk.right', 9);\n        game.addSpriteAnimation(grobelin, 'lpc.thrust.back', 9);\n        game.addSpriteAnimation(grobelin, 'lpc.thrust.front', 9);\n        game.addSpriteAnimation(grobelin, 'lpc.thrust.left', 9);\n        game.addSpriteAnimation(grobelin, 'lpc.thrust.right', 9);\n        return grobelin;\n    }\n\n    private appears() {\n        if (this.game.time.time >= this.nextAppearsTime) {\n            const grobelin = <Grobelin>this.getFirstExists(false);\n            if (grobelin) {\n                const pos = this.pathfinder.randomWalkablePos();\n                grobelin.appears(pos.x, pos.y, this.target);\n                this.nextAppearsTime = this.game.time.time + this.appearsRate;\n            }\n        }\n    }\n}","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport { ShmuprpgGame } from \"../ShmuprpgGame.ts\";\nimport { MachineGun } from \"./MachineGun.ts\";\nimport { Controls } from \"../utils/Controls.ts\";\n\nexport class Hero extends Phaser.Sprite {\n\n    weapon: MachineGun;\n    controls: Controls;\n\n    constructor(game: Phaser.Game) {\n        super(game, game.world.centerX, game.world.centerY, 'tobira');\n        this.health = 3;\n        this.controls = (<ShmuprpgGame>game).controls;\n        (<ShmuprpgGame>game).addSpriteAnimation(this, 'lpc.hurt', 6);\n        (<ShmuprpgGame>game).addSpriteAnimation(this, 'lpc.walk.back', 9);\n        (<ShmuprpgGame>game).addSpriteAnimation(this, 'lpc.walk.front', 9);\n        (<ShmuprpgGame>game).addSpriteAnimation(this, 'lpc.walk.left', 9);\n        (<ShmuprpgGame>game).addSpriteAnimation(this, 'lpc.walk.right', 9);\n        this.play(\"lpc.hurt\", 0, false);\n        this.anchor.setTo(0.5, 0.5);\n        this.game.physics.enable(this, Phaser.Physics.ARCADE);\n        this.body.setSize(16, 16, 24, 48);\n        this.body.collideWorldBounds = true;\n        this.weapon = new MachineGun(this.game);\n        this.game.add.existing(this.weapon);\n    }\n\n    static preload(game: Phaser.Game) {\n        game.load.atlasXML('tobira', 'sprites/lpc/characters/tobira.png', 'sprites/lpc/characters/lpc.xml');\n        game.load.spritesheet('bullet', 'sprites/lpc/shootemup/effects01.png', 16, 16, 4);\n    }\n\n    update() {\n        super.update();\n        this.body.velocity.x = 0;\n        this.body.velocity.y = 0;\n\n        if (this.controls.isGoingLeft()) {\n            this.body.velocity.x = -300;\n        } else if (this.controls.isGoingRight()) {\n            this.body.velocity.x = 300;\n        }\n\n        if (this.controls.isGoingUp()) {\n            this.body.velocity.y = -300;\n        } else if (this.controls.isGoingDown()) {\n            this.body.velocity.y = 300;\n        }\n\n        if (this.body.velocity.y < 0) {\n            this.play(\"lpc.walk.back\", 8, false);\n        } else if (this.body.velocity.y > 0) {\n            this.play(\"lpc.walk.front\", 8, false);\n        } else if (this.body.velocity.x < 0) {\n            this.play(\"lpc.walk.left\", 8, false);\n        } else if (this.body.velocity.x > 0) {\n            this.play(\"lpc.walk.right\", 8, false);\n        } else {\n            this.play(\"lpc.hurt\", 0, false);\n        }\n\n        const shootingAngle = this.controls.shootingAngle(this.x, this.y);\n        if (shootingAngle != null) {\n            this.weapon.fire(this.x, this.y, shootingAngle);\n        }\n\n    }\n\n    invincible = false;\n\n    damage(amount: number): Phaser.Sprite {\n        if (!this.invincible) {\n            this.invincible = true;\n            this.game.add.tween(this).from({ tint: 0xFF0000 }).to({ tint: 0xFFFFFF }, 1000, Phaser.Easing.Linear.None, true, 0, 4, false).onComplete.add(() => this.invincible = false);\n            super.damage(amount);\n            if (!this.alive) {\n                this.game.state.start('GameOver')\n            }\n        }\n        return this;\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport {Bullet} from \"./Bullet.ts\";\n\nexport class MachineGun extends Phaser.Group {\n\n    bulletSpeed = 600;\n    fireRate = 200;\n    nextFireTime = 0;\n\n    constructor(game: Phaser.Game, maxBullets: number = 64) {\n        super(game);\n        for (let i = 0; i < maxBullets; ++i) {\n            this.add(this.createBullet());\n        }\n    }\n\n    createBullet(): Bullet {\n        const bullet = new Bullet(this.game);\n        return bullet;\n    }\n\n    fire(fromX: number, fromY: number, angle: number) {\n        if (this.game.time.time >= this.nextFireTime) {\n            const bullet = this.getFirstExists(false);\n            if (bullet) {\n                bullet.fire(fromX, fromY, angle, this.bulletSpeed, 0, 0);\n                this.nextFireTime = this.game.time.time + this.fireRate;\n            }\n        }\n    }\n}","/// <reference path=\"../../typings/phaser.d.ts\"/>\nexport abstract class AbstractState extends Phaser.State {\n\n    constructor() {\n        super();\n    }\n\n    create() {\n        this.game.input.keyboard.addKey(Phaser.Keyboard.F).onDown.add(() => this.toggleFullscreen());\n    }\n\n    toggleFullscreen() {\n        if (this.game.scale.isFullScreen) {\n            this.game.scale.stopFullScreen();\n        } else {\n            this.game.scale.startFullScreen();\n        }\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport { AbstractState } from \"./AbstractState.ts\"; // you import only AClass\n\nexport class GameOver extends AbstractState {\n\n    constructor() {\n        super();\n    }\n\n    preload() {\n        this.game.load.image('gameover', 'gameover/gameover.png');\n    }\n\n    create() {\n        super.create();\n        this.game.add.image(0, 0, 'gameover');\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport { AbstractState } from \"./AbstractState.ts\"; // you import only AClass\n\nexport class Intro extends AbstractState {\n\n    constructor() {\n        super();\n    }\n\n    preload() {\n        this.game.load.video('intro', 'intro/intro.webm');\n    }\n\n    create() {\n        super.create();\n        var video = this.game.add.video('intro');\n        video.play();\n        video.addToWorld(this.game.world.centerX, this.game.world.centerY, 0.5, 0.5);\n        video.onComplete.add(() => this.game.state.start('Title'));\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport { AbstractState } from \"./AbstractState.ts\";\nimport { Hero } from \"../entities/Hero.ts\";\nimport {BirdFlock} from \"../entities/BirdFlock.ts\";\nimport {GrobelinHorde} from \"../entities/GrobelinHorde.ts\";\nimport {Grobelin} from \"../entities/Grobelin.ts\";\n\nimport {Pathfinder} from \"../utils/Pathfinder.ts\"\n\nexport class Level extends AbstractState {\n\n    hero: Hero;\n    collisionSprites: Phaser.Group;\n    birdFlock: BirdFlock;\n    grobelinHorde: GrobelinHorde;\n    pathfinder: Pathfinder;\n\n    constructor() {\n        super();\n    }\n\n    preload() {\n        BirdFlock.preload(this.game);\n        GrobelinHorde.preload(this.game);\n        Hero.preload(this.game);\n        this.game.load.tilemap('map', 'levels/level1.json', null, Phaser.Tilemap.TILED_JSON);\n        this.game.load.image('terrains', 'sprites/lpc/terrains/terrains.png');\n        this.game.load.image('cottage', 'sprites/lpc/thatched-roof-cottage/cottage.png');\n        this.game.load.image('thatched-roof', 'sprites/lpc/thatched-roof-cottage/thatched-roof.png');\n        this.game.load.image('doors', 'sprites/lpc/windows-doors/doors.png');\n        this.game.load.image('windows', 'sprites/lpc/windows-doors/windows.png');\n        this.game.load.image('obj_misk_atlas', 'sprites/lpc/tile-atlas2/obj_misk_atlas.png');\n    }\n\n    create() {\n        super.create();\n        this.game.physics.startSystem(Phaser.Physics.ARCADE);\n        const map = this.game.add.tilemap('map');\n        map.addTilesetImage('terrains');\n        map.addTilesetImage('cottage');\n        map.addTilesetImage('thatched-roof');\n        map.addTilesetImage('doors');\n        map.addTilesetImage('windows');\n        map.addTilesetImage('obj_misk_atlas');\n\n        const layer = map.createLayer('grounds');\n        map.createLayer('plants');\n        map.createLayer('walls');\n        map.createLayer('bridges');\n        map.createLayer('doors_and_windows');\n        map.createLayer('roofs');\n        layer.resizeWorld();\n\n        this.collisionSprites = this.game.add.physicsGroup(Phaser.Physics.ARCADE);;\n        for (let o of map.objects['collision']) {\n            if (o.rectangle) {\n                const sprite = this.game.add.sprite(o.x, o.y);\n                this.game.physics.enable(sprite, Phaser.Physics.ARCADE);\n                sprite.body.immovable = true;\n                sprite.width = o.width;\n                sprite.height = o.height;\n                this.collisionSprites.add(sprite);\n            }\n        }\n\n        this.pathfinder = new Pathfinder(map);\n\n        this.hero = new Hero(this.game);\n        this.game.add.existing(this.hero);\n        this.birdFlock = new BirdFlock(this.hero);\n        this.game.add.existing(this.birdFlock);\n        this.grobelinHorde = new GrobelinHorde(this.hero, this.pathfinder);\n        this.game.add.existing(this.grobelinHorde);\n    }\n\n    update() {\n        this.pathfinder.update();\n        this.hero.update();\n        this.game.physics.arcade.collide(this.hero, this.collisionSprites);\n        this.resolveWeaponsEffects();\n    }\n\n    resolveWeaponsEffects() {\n        this.game.physics.arcade.overlap(this.birdFlock, this.hero.weapon, (bird: Phaser.Sprite, bullet: Phaser.Sprite) => {\n            bird.kill();\n            bullet.kill();\n        });\n        this.game.physics.arcade.overlap(this.hero, this.birdFlock, (hero: Phaser.Sprite, bird: Phaser.Sprite) => {\n            bird.kill();\n            this.hero.damage(1);\n        });\n        for (let b of this.hero.weapon.children) {\n            const bullet = <Phaser.Sprite>b;\n            if (bullet.exists) {\n                const bulletRect = new Phaser.Rectangle(bullet.x, bullet.y, bullet.width, bullet.height);\n                grobelins_loop: for (let c of this.grobelinHorde.children) {\n                    const grobelin = <Grobelin>c;\n                    if (grobelin.exists) {\n                        for (let v of grobelin.getVulnerableRectangles()) {\n                            if (bulletRect.intersects(v, 1)) {\n                                bullet.kill();\n                                grobelin.damage(1);\n                                break grobelins_loop;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    render() {\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\nimport { AbstractState } from \"./AbstractState.ts\"; // you import only AClass\n\nexport class Title extends AbstractState {\n\n    constructor() {\n        super();\n    }\n\n    preload() {\n        this.game.load.image('logo', 'title/logo.png');\n    }\n\n    create() {\n        super.create();\n        var logo = this.game.add.sprite(this.game.world.centerX, this.game.world.centerY, 'logo');\n        logo.anchor.setTo(0.5, 0.5);\n    }\n}\n","/// <reference path=\"../../typings/phaser.d.ts\"/>\n\nexport class Controls {\n    kb: Phaser.Keyboard;\n    pad: Phaser.SinglePad;\n    game: Phaser.Game;\n\n    constructor(game: Phaser.Game) {\n        this.game = game;\n        game.input.gamepad.start();\n        this.kb = game.input.keyboard;\n        this.pad = game.input.gamepad.pad1;\n    }\n\n    shootingAngle(shooterX: number, shooterY: number): number {\n        return this.firstNonNull(this.shootingAngleFromPointer(shooterX, shooterY)\n            , this.shootingAngleFromPad(),\n            this.shootingFromKeyboard());\n    }\n\n    private firstNonNull<T>(...values: T[]): T {\n        for (let value of values) {\n            if (value != null) {\n                return value;\n            }\n        }\n        return null;\n    }\n\n    private shootingAngleFromPointer(shooterX: number, shooterY: number): number {\n        const pointer = this.game.input.activePointer;\n        if (pointer.isDown) {\n            return Phaser.Math.angleBetween(shooterX, shooterY, pointer.worldX, pointer.worldY);\n        } else {\n            return this.shootingFromKeyboard();\n        }\n    }\n\n    private shootingAngleFromPad(): number {\n        let dx = this.pad.axis(Phaser.Gamepad.XBOX360_STICK_RIGHT_X);\n        let dy = this.pad.axis(Phaser.Gamepad.XBOX360_STICK_RIGHT_Y);\n        dx = Math.abs(dx) <= this.pad.deadZone ? 0 : dx;\n        dy = Math.abs(dy) <= this.pad.deadZone ? 0 : dy;\n        if (dx != 0 || dy != 0) {\n            return Phaser.Math.angleBetween(0, 0, dx, dy);\n        } else {\n            return null;\n        }\n    }\n\n    private shootingFromKeyboard(): number {\n        let dx = 0;\n        if (this.kb.isDown(Phaser.KeyCode.J)) {\n            dx = -1;\n        } else if (this.kb.isDown(Phaser.KeyCode.L)) {\n            dx = 1;\n        }\n        let dy = 0;\n        if (this.kb.isDown(Phaser.KeyCode.I)) {\n            dy = -1;\n        } else if (this.kb.isDown(Phaser.KeyCode.K)) {\n            dy = 1;\n        }\n        if (dx != 0 || dy != 0) {\n            return Phaser.Math.angleBetween(0, 0, dx, dy);\n        } else {\n            return null;\n        }\n    }\n\n    isGoingUp(): boolean {\n        return this.pad.isDown(Phaser.Gamepad.XBOX360_DPAD_UP)\n            || this.pad.axis(Phaser.Gamepad.XBOX360_STICK_LEFT_Y) < -this.pad.deadZone\n            || this.kb.isDown(Phaser.KeyCode.UP)\n            || this.kb.isDown(Phaser.KeyCode.Z);\n    }\n    isGoingDown(): boolean {\n        return this.pad.isDown(Phaser.Gamepad.XBOX360_DPAD_DOWN)\n            || this.pad.axis(Phaser.Gamepad.XBOX360_STICK_LEFT_Y) > this.pad.deadZone\n            || this.kb.isDown(Phaser.KeyCode.DOWN)\n            || this.kb.isDown(Phaser.KeyCode.S);\n    }\n\n    isGoingLeft(): boolean {\n        return this.pad.isDown(Phaser.Gamepad.XBOX360_DPAD_LEFT)\n            || this.pad.axis(Phaser.Gamepad.XBOX360_STICK_LEFT_X) < -this.pad.deadZone\n            || this.kb.isDown(Phaser.KeyCode.LEFT)\n            || this.kb.isDown(Phaser.KeyCode.Q);\n    }\n\n    isGoingRight(): boolean {\n        return this.pad.isDown(Phaser.Gamepad.XBOX360_DPAD_RIGHT)\n            || this.pad.axis(Phaser.Gamepad.XBOX360_STICK_LEFT_X) > this.pad.deadZone\n            || this.kb.isDown(Phaser.KeyCode.RIGHT)\n            || this.kb.isDown(Phaser.KeyCode.D);\n    }\n}","/// <reference path=\"../../typings/easystarjs.d.ts\" />\n/// <reference path=\"../../typings/brunch-require.d.ts\" />\nimport EasyStar = require('easystarjs');\n\nexport class Pathfinder {\n\n    private easystar: EasyStar.js;\n    private map: Phaser.Tilemap;\n\n    constructor(map: Phaser.Tilemap) {\n        this.map = map;\n        const pathfindLayer = map.getLayerIndex('pathfind');\n        const grid = new Array<Array<number>>();\n        for (let row = 0; row < map.height; ++row) {\n            var gridRow = new Array<number>(map.width);\n            for (let column = 0; column < map.width; ++column) {\n                const tile = map.getTile(column, row, pathfindLayer);\n                gridRow[column] = this.isTileWalkable(tile) ? 1 : 0;\n            }\n            grid[row] = gridRow;\n        }\n        this.easystar = new EasyStar.js();\n        this.easystar.setGrid(grid);\n        this.easystar.enableDiagonals();\n        this.easystar.setAcceptableTiles([1]);\n    }\n\n    randomWalkablePos(): Phaser.Point {\n        const pathfindLayer = this.map.getLayerIndex('pathfind');\n        const rnd = this.map.game.rnd;\n        const maxChances = this.map.width * this.map.height;\n        for (let i = 0; i < maxChances; ++i) {\n            const x = rnd.integerInRange(0, this.map.width - 1);\n            const y = rnd.integerInRange(0, this.map.height - 1);\n            const tile = this.map.getTile(x, y, pathfindLayer);\n            if (this.isTileWalkable(tile)) {\n                return new Phaser.Point(tile.worldX, tile.worldY);\n            }\n        }\n        return null;\n    }\n\n    isTileWalkable(tile: Phaser.Tile) {\n        return tile && tile.properties['walkable'] == 1;\n    }\n\n    findPath(startX: number, startY: number, endX: number, endY: number, callback: (path: Phaser.Point[]) => void) {\n        const tileStart = this.map.getTileWorldXY(startX, startY);\n        const tileEnd = this.findNearestWalkableTile(endX, endY);\n        if (tileEnd) {\n            this.easystar.findPath(tileStart.x, tileStart.y, tileEnd.x, tileEnd.y, (path: { x: number, y: number }[]) => {\n                let worldPath: Array<Phaser.Point>;\n                if (path && path.length>1) {\n                    worldPath = new Array<Phaser.Point>(path.length-1);\n                    for (let i = 1; i < path.length; ++i) {\n                        const tile = this.map.getTile(path[i].x, path[i].y);\n                        worldPath[i-1] = new Phaser.Point(tile.worldX + tile.width / 2, tile.worldY + tile.height / 2);\n                    }\n                } else {\n                    worldPath = new Array<Phaser.Point>();\n                }                \n                callback(worldPath);\n            });\n        } else {\n            callback(new Array<Phaser.Point>());\n        }\n    }\n    findNearestWalkableTile(endX: number, endY: number) {\n        const pathfindLayer = this.map.getLayerIndex('pathfind');\n        const tile = this.map.getTileWorldXY(endX, endY, this.map.tileWidth, this.map.tileHeight, pathfindLayer);\n        if (this.isTileWalkable(tile)) {\n            return tile;\n        }\n        let minTile = null;\n        let minTileDistance = null;\n        for (let dx = -10; dx < 10; ++dx) {\n            for (let dy = -10; dy < 10; ++dy) {\n                const t = this.map.getTile(tile.x + dx, tile.y + dy, pathfindLayer);\n                if (this.isTileWalkable(t)) {\n                    const tileDistance = Phaser.Math.distanceSq(0, 0, dx, dy);\n                    if (!minTileDistance || tileDistance < minTileDistance) {\n                        minTileDistance = tileDistance;\n                        minTile = t;\n                    }\n                }\n            }\n        }\n        return minTile;\n    }\n    update() {\n        this.easystar.calculate();\n    }\n\n}"]}